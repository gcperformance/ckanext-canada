{% set lang = h.lang() %}

{% set home_link_title = _('Registry Home') %}
{% if not g.is_registry %}
  {% set home_link_title = _('Open Government Portal') %}
{% endif %}

{% set breadcrumbs = [] %}
{# TODO: solve the breadcrumbing #}
{% if breadcrumb_content|trim %}
  {% do breadcrumbs.append({"title": home_link_title, "href": '/' ~ (lang or 'en')}) %}
  {% do breadcrumbs.append({"title": page_title, "href": h.current_url()}) %}
{% endif %}

{# See: https://github.com/wet-boew/cdts-sgdc/blob/v4.1.0/src/gcweb/appTop.ejs #}
<script>
  let appTop = document.getElementById("app-top");
  if( appTop ){
    appTop.outerHTML = wet.builder.appTop({
      "search": "{{ 0 if g.is_registry else 1 }}",
      "lngLinks": [
        {
          "lang": "{{ 'en' if lang == 'fr' else 'fr' }}",
          "href": "{{ h.url_for(h.current_url(), locale=('en' if lang == 'fr' else 'fr')) }}",
          "text": "{{ 'English' if lang == 'fr' else 'Fran√ßais' }}",
        }
      ],
      "menuPath": "{{ h.url_for('canada.site_menu') }}",
      "breadcrumbs": {{ breadcrumbs|tojson }},
    });
  }
</script>
